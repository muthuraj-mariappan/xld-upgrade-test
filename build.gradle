buildscript {
    repositories {
        mavenLocal()
        maven {
            url 'https://oss.sonatype.org/service/local/repositories/releases/content'
        }
        ["releases", "public"].each { r ->
            maven {
                url "${nexusBaseUrl}/repositories/${r}"
                credentials {
                    username nexusUserName
                    password nexusPassword
                }
            }
        }
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath("com.xebialabs.gradle.plugins:integration-server-gradle-plugin:10.4.0-SNAPSHOT")
    }
}

plugins {
    id 'scala'
    id 'idea'
}

repositories {
    mavenCentral()
}

apply plugin: "integration.server"

integrationServer {
    servers {
        upgradeSource {
            previousInstallation = true
            version = "10.1.0"
            httpPort = 4519
            overlays = [
                    conf: [
                            files("src/test/resources/deployit-license.lic")
                    ]
            ]
        }
        controlPlane {
            version = "10.3.0-917.113"
            httpPort = 4519
        }
    }
}

rootProject.afterEvaluate {
    startIntegrationServer.dependsOn(build)
}
